
<div class="row">
  <div class="col-md-6">
    <div class="topology-column-content-head">
      <span class="ng-binding">
        <i class="fa fa-list"></i> {{'SERVICES.LIST'}}
      </span>
    </div>
    <div class="row-margin">
      <form role="search" ng-submit="searchService.search()">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="..." ng-model="query">
          <span class="input-group-btn">
            <button type="submit" class="btn btn-default" data-loading-text="Loading...">
              <i class="fa fa-search"></i>
            </button>
          </span>
        </div>
      </form>
    </div>
    <div id="services-container" class="drop-container" alien-droppable drag-on-drop="addService(data)">
      <empty-place-holder for="'services'" data="serviceResources"></empty-place-holder>
      <table ng-if="serviceResources && serviceResources.length > 0" class="table table-hover">
        <thead>
          <th>Name</th>
          <th>Version</th>
          <th>Type</th>
          <th>State</th>
          <th></th>
        </thead>
        <tbody>
          <tr ng-repeat="serviceResource in serviceResources" id='service_{{serviceResource.id}}' class="clickable" ng-click="selectService(serviceResource)"
          ng-class="{'warning': selectedService.id === serviceResource.id}">
            <td>{{serviceResource.name}}</td>
            <td>{{serviceResource.version}}</td>
            <td>{{serviceResource.nodeInstance.nodeTemplate.type}}</td>
            <td>{{serviceResource.nodeInstance.attributeValues.state}}</td>
            <td><delete-confirm id='delete-service_{{serviceResource.id}}' func="delete(serviceResource.id)" position="right" bssize="btn-sm" fastyle="fa-trash-o" disable="serviceResource.nodeInstance.attributeValues.state !== 'initial'">
            </delete-confirm></td>
          </tr>
        </tbody>
      </table>
      <div>
        <pagination-directive pagination-info="searchService.pagination"/>
      </div>
      <div class="drop-container-label">
        <i class="fa fa-plus"></i>&nbsp;{{ 'ORCHESTRATORS.LOCATIONS.RESOURCES.DROP' | translate }}
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div id="catalog-container" ng-if="!selectedService">
      <div class="topology-column-content-head">
        <span class="ng-binding">
          <i class="fa fa-cubes"></i> {{'SERVICES.CATALOG'}}
        </span>
      </div>
      <alien-search-node-type
              display-detail-pannel="false"
              drag-and-drop-enabled="true"
              height-info="dimensions",
              badges="badges">
      </alien-search-node-type>
    </div>
    <div id="service-configuration" ng-if="selectedService">
      <div class="topology-column-content-head">
        <span class="ng-binding">
          <i class="fa fa-globe"></i> {{'SERVICES.DETAIL.TITLE' | translate}}
        </span>
        <a id="closeSelection" class="pull-right" style="font-weight: 400;" ng-click="selectService()">
          <i class="fa fa-arrow-left"></i> {{'SERVICES.DETAIL.BACK' | translate}}
        </a>
      </div>
      <uib-tabset justified="true">
        <uib-tab>
          <uib-tab-heading>
            <i class="fa fa-list" aria-hidden="true"></i>&nbsp;{{'SERVICES.DETAIL.DETAIL' | translate}}
          </uib-tab-heading>
          <div>
            <div class="row row-margin">
              <div class="col-md-3">
                <strong>{{'COMMON.NAME' | translate}}</strong>
              </div>
              <div class="col-md-9">
                <div id="srv-name" editable-text="selectedService.name" onbeforesave="update({'name': $data})" e-class="editable-input-lg" e-required blur="submit" buttons="no">
                  {{selectedService.name}} <i class="fa fa-edit"></i>
                </div>
              </div>
            </div>
            <div class="row row-margin">
              <div class="col-md-3">
                <strong>{{'COMMON.VERSION' | translate}}</strong>
              </div>
              <div class="col-md-9">
                <div id="srv-version" editable-text="selectedService.version" onbeforesave="update({'version': $data})" e-class="editable-input-lg" e-required blur="submit" buttons="no">
                  {{selectedService.version}} <i class="fa fa-edit"></i>
                </div>
              </div>
            </div>
            <div class="row row-margin">
              <div class="col-md-3">
                <strong>{{'COMMON.DESCRIPTION' | translate}}</strong>
              </div>
              <div id="srv-desc" class="col-md-9">
                <div style="white-space: pre;" editable-textarea="selectedService.description" onbeforesave="update({'description': $data})" e-class="editable-input-lg" e-required blur="submit" buttons="no">{{selectedService.description}} <i class="fa fa-edit"></i></div>
              </div>
            </div>
            <div class="row row-margin">
              <div class="col-md-3">
                <strong>{{'COMMON.STATE' | translate}}</strong>
              </div>
              <div class="col-md-9">
                <div class="switch" ng-click="toggleState()">
                  <div class="switch-slider" ng-class="stateDisabled ? 'disabled' : 'enabled'"></div>
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab>
          <uib-tab-heading>
            <i class="fa fa-cube" aria-hidden="true"></i>&nbsp;{{'SERVICES.INSTANCE' | translate}}
          </uib-tab-heading>
          <a4c-node-template-edit ng-if="selectedNodeType"
            node-template="selectedService.nodeInstance.nodeTemplate"
            node-type="selectedNodeType"
            node-capability-types="selectedCapabilityTypes"
            dependencies="selectedDependencies"
            is-property-editable="isPropertyEditable()"
            on-property-update="updateProperty(propertyName, propertyValue)"
            on-capability-property-update="updateCapabilityProperty(capabilityName, propertyName, propertyValue)">
          </a4c-node-template-edit>
          <!-- Attributes -->
          <div ng-if="selectedNodeType.attributes.length > 0">
            <div id="node-details-attributes" class="clickable topology-column-content-head" ng-click="isAttributesCollapsed = !isAttributesCollapsed">
              <i class="fa" ng-class="{'fa-caret-down' : !isAttributesCollapsed, 'fa-caret-right': isAttributesCollapsed}"></i>
              {{'COMMON.ATTRIBUTES' | translate}}
            </div>
            <div id="node-details-attributes-panel" uib-collapse="isAttributesCollapsed" >
              <table class="table table-condensed" id="nodeAttributes">
                <tr ng-repeat="attrEntry in selectedNodeType.attributes">
                  <td>
                    <label>{{attrEntry.key}}</label>
                  </td>
                  <td>
                    <span editable-text="selectedService.nodeInstance.attributeValues[attrEntry.key]" buttons="no" onbeforesave="updateAttribute(attrEntry.key, $data)" blur="submit" class="editable editable-click">
                      {{selectedService.nodeInstance.attributeValues[attrEntry.key]}} <i class="fa fa-pencil-square-o"></i>
                    </span>
                  </td>
                  <td>
                    <simple-modal class="pull-right" title="{{ 'MODAL.TITLE.PROPERTY' | translate}}" content="{{attrEntry.value.description}}"
                                  key="{{attrEntry.key}}"></simple-modal>
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </uib-tab>
        <uib-tab>
          <uib-tab-heading>
            <i class="fa fa-cloud" aria-hidden="true"></i>&nbsp;{{'ORCHESTRATORS.NAV.LOCATIONS' | translate}}
          </uib-tab-heading>
          <empty-place-holder for="'locations'" data="locations"></empty-place-holder>
          <table ng-if="locations.length > 0" class="table table-hover">
            <thead>
              <th>Orchestrator</th>
              <th>Location</th>
              <th>Authorized</th>
            </thead>
            <tbody>
              <tr ng-repeat="location in locations track by location.id">
                <td>{{location.orchestratorName}}</td>
                <td>{{location.name}}</td>
                <td>
                  <button class="btn btn-sm btn-transparent" id="btn_loc_{{location.id}}" ng-click="toggleLoc(location)">
                    <i class="fa" ng-class="isLocAuthorized(location) ? 'fa-check-square-o text-success' :'fa-square-o'" ng-click="item.checked = !item.checked"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </uib-tab>
        <uib-tab>
          <uib-tab-heading>
            <i class="fa fa-lock" aria-hidden="true"></i>&nbsp;{{'ORCHESTRATORS.LOCATIONS.SECURITY' | translate}}
          </uib-tab-heading>
          Service security
        </uib-tab>
      </uib-tabset>
    </div>
  </div>
</div>
